/**
 * 自定义简单的广播对象 (web模块)
 * Created by wuxp on 2017/5/31.
 */

if (weex.config.env.platform.toLowerCase() === 'web') {
    const broadcastWeexModule = {
        register (category, eventName, succFn=()=>{}, errorFn=()=>{}) {
            broadcastWeexModule.eventMaps[broadcastWeexModule.getEventName(category, eventName)] = {
                success: succFn,
                error: errorFn == null ? () => {
                } : errorFn
            };
            console.log("注册事件成功--> "+category+":"+eventName);
        },
        send (category, eventName, data={}, error={}) {
            console.log("发送广播事件")
            console.log(data)
            broadcastWeexModule.eventMaps[broadcastWeexModule.getEventName(category, eventName)].success({
                category,
                data,
                eventName
            });
            broadcastWeexModule.eventMaps[broadcastWeexModule.getEventName(category, eventName)].error({
                category,
                data:error,
                eventName
            });
        },
        getEventName(category, eventName){
            return category + "_" + eventName;
        },
        eventMaps: {}
    };
    console.log("注册自定义模块 broadcast");
    weex.registerModule('broadcast', broadcastWeexModule);
}
